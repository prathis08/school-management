import fetch from \"node-fetch\";\n\nconst API_BASE_URL = \"http://localhost:50501/api\";\n\nasync function testTaskManagementAPI() {\n  try {\n    console.log(\"ðŸ§ª Testing Task Management API...\");\n    \n    // First, login to get authentication token\n    console.log(\"\\n1. Logging in to get authentication token...\");\n    const loginResponse = await fetch(`${API_BASE_URL}/auth/login-user`, {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n      body: JSON.stringify({\n        email: \"test@example.com\",\n        password: \"password123\",\n      }),\n    });\n\n    const loginData = await loginResponse.json();\n    console.log(\"Login Response Status:\", loginResponse.status);\n\n    if (!loginResponse.ok || !loginData.success) {\n      console.log(\"âŒ Login failed. Please ensure you have valid test credentials.\");\n      console.log(\"Login Response:\", JSON.stringify(loginData, null, 2));\n      return;\n    }\n\n    const { accessToken } = loginData.data;\n    console.log(\"âœ… Login successful!\");\n\n    const authHeaders = {\n      \"Authorization\": `Bearer ${accessToken}`,\n      \"Content-Type\": \"application/json\",\n    };\n\n    // Test creating a new task\n    console.log(\"\\n2. Testing task creation...\");\n    const newTask = {\n      title: \"Test Task\",\n      description: \"This is a test task created via API\",\n      dueDate: \"2025-12-31\",\n      dueTime: \"14:30\",\n      priority: \"high\",\n      tags: [\"testing\", \"api\"],\n    };\n\n    const createResponse = await fetch(`${API_BASE_URL}/tasks`, {\n      method: \"POST\",\n      headers: authHeaders,\n      body: JSON.stringify(newTask),\n    });\n\n    const createData = await createResponse.json();\n    console.log(\"Create Task Response Status:\", createResponse.status);\n    console.log(\"Create Task Response:\", JSON.stringify(createData, null, 2));\n\n    let taskId = null;\n    if (createResponse.ok && createData.success) {\n      taskId = createData.data.id;\n      console.log(\"âœ… Task created successfully!\");\n      console.log(`ðŸ“ Task ID: ${taskId}`);\n    } else {\n      console.log(\"âŒ Task creation failed\");\n    }\n\n    // Test getting all tasks\n    console.log(\"\\n3. Testing get all tasks...\");\n    const tasksResponse = await fetch(`${API_BASE_URL}/tasks?page=1&limit=10`, {\n      method: \"GET\",\n      headers: authHeaders,\n    });\n\n    const tasksData = await tasksResponse.json();\n    console.log(\"Get Tasks Response Status:\", tasksResponse.status);\n    console.log(\"Get Tasks Response:\", JSON.stringify(tasksData, null, 2));\n\n    if (tasksResponse.ok && tasksData.success) {\n      console.log(\"âœ… Tasks retrieved successfully!\");\n      console.log(`ðŸ“Š Total tasks: ${tasksData.data.pagination.totalTasks}`);\n    } else {\n      console.log(\"âŒ Get tasks failed\");\n    }\n\n    // Test getting task by ID (if we have a task ID)\n    if (taskId) {\n      console.log(\"\\n4. Testing get task by ID...\");\n      const taskResponse = await fetch(`${API_BASE_URL}/tasks/${taskId}`, {\n        method: \"GET\",\n        headers: authHeaders,\n      });\n\n      const taskData = await taskResponse.json();\n      console.log(\"Get Task by ID Response Status:\", taskResponse.status);\n      console.log(\"Get Task by ID Response:\", JSON.stringify(taskData, null, 2));\n\n      if (taskResponse.ok && taskData.success) {\n        console.log(\"âœ… Task details retrieved successfully!\");\n      } else {\n        console.log(\"âŒ Get task by ID failed\");\n      }\n\n      // Test updating the task\n      console.log(\"\\n5. Testing task update...\");\n      const updateData = {\n        title: \"Updated Test Task\",\n        status: \"in-progress\",\n        priority: \"medium\",\n      };\n\n      const updateResponse = await fetch(`${API_BASE_URL}/tasks/${taskId}`, {\n        method: \"PUT\",\n        headers: authHeaders,\n        body: JSON.stringify(updateData),\n      });\n\n      const updateResponseData = await updateResponse.json();\n      console.log(\"Update Task Response Status:\", updateResponse.status);\n      console.log(\"Update Task Response:\", JSON.stringify(updateResponseData, null, 2));\n\n      if (updateResponse.ok && updateResponseData.success) {\n        console.log(\"âœ… Task updated successfully!\");\n      } else {\n        console.log(\"âŒ Task update failed\");\n      }\n\n      // Test adding a comment\n      console.log(\"\\n6. Testing add comment...\");\n      const commentData = {\n        content: \"This is a test comment added via API\",\n      };\n\n      const commentResponse = await fetch(`${API_BASE_URL}/tasks/${taskId}/comments`, {\n        method: \"POST\",\n        headers: authHeaders,\n        body: JSON.stringify(commentData),\n      });\n\n      const commentResponseData = await commentResponse.json();\n      console.log(\"Add Comment Response Status:\", commentResponse.status);\n      console.log(\"Add Comment Response:\", JSON.stringify(commentResponseData, null, 2));\n\n      if (commentResponse.ok && commentResponseData.success) {\n        console.log(\"âœ… Comment added successfully!\");\n      } else {\n        console.log(\"âŒ Add comment failed\");\n      }\n    }\n\n    // Test getting task statistics\n    console.log(\"\\n7. Testing task statistics...\");\n    const statsResponse = await fetch(`${API_BASE_URL}/tasks/statistics`, {\n      method: \"GET\",\n      headers: authHeaders,\n    });\n\n    const statsData = await statsResponse.json();\n    console.log(\"Task Statistics Response Status:\", statsResponse.status);\n    console.log(\"Task Statistics Response:\", JSON.stringify(statsData, null, 2));\n\n    if (statsResponse.ok && statsData.success) {\n      console.log(\"âœ… Task statistics retrieved successfully!\");\n      console.log(\"ðŸ“ˆ Statistics:\");\n      console.log(`  - Total: ${statsData.data.total}`);\n      console.log(`  - Pending: ${statsData.data.pending}`);\n      console.log(`  - In Progress: ${statsData.data.inProgress}`);\n      console.log(`  - Completed: ${statsData.data.completed}`);\n    } else {\n      console.log(\"âŒ Get task statistics failed\");\n    }\n\n    // Test unauthorized access\n    console.log(\"\\n8. Testing unauthorized access...\");\n    const unauthorizedResponse = await fetch(`${API_BASE_URL}/tasks`, {\n      method: \"GET\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n    });\n\n    const unauthorizedData = await unauthorizedResponse.json();\n    console.log(\"Unauthorized Response Status:\", unauthorizedResponse.status);\n    console.log(\"Unauthorized Response:\", JSON.stringify(unauthorizedData, null, 2));\n\n    if (unauthorizedResponse.status === 401) {\n      console.log(\"âœ… Correctly rejected unauthorized request\");\n    } else {\n      console.log(\"âŒ Expected 401 status for unauthorized request\");\n    }\n\n    console.log(\"\\nðŸŽ‰ Task Management API testing completed!\");\n\n  } catch (error) {\n    console.error(\"âŒ Test failed with error:\", error.message);\n  }\n}\n\n// Run the tests\n(async () => {\n  await testTaskManagementAPI();\n})();\n